BOTH
from vimba import *
import cv2

vimba = Vimba()
vimba.startup()

camera1 = vimba.camera(0) # Camera 1
camera2 = vimba.camera(1) # Camera 2

camera1.open()
camera2.open()

# Set camera parameters
camera1.PixelFormat = 'BGR8'
camera1.AcquisitionMode = 'Continuous'
camera1.ExposureTime = 10000
camera1.Gain = 0

camera2.PixelFormat = 'BGR8'
camera2.AcquisitionMode = 'Continuous'
camera2.ExposureTime = 10000
camera2.Gain = 0

camera1.start_capture()
camera2.start_capture()

try:
    while True:
        # Capture an image from each camera and timestamp it
        image1 = camera1.get_image()
        timestamp1 = image1.timestamp

        image2 = camera2.get_image()
        timestamp2 = image2.timestamp

        # Calculate the time difference between the two images
        time_diff = (timestamp2 - timestamp1).total_seconds() * 1000

        # Adjust the exposure time of the slower camera accordingly
        if time_diff > 0:
            camera1.ExposureTime += time_diff
        else:
            camera2.ExposureTime -= time_diff

        # Convert the image data to OpenCV format
        img1 = image1.buffer_data_numpy()
        img2 = image2.buffer_data_numpy()

        # Display the images
        cv2.imshow('Camera 1', img1)
        cv2.imshow('Camera 2', img2)

        key = cv2.waitKey(1) & 0xFF
        if key == ord('q'):
            break
finally:
    camera1.stop_capture()
    camera2.stop_capture()
    camera1.revoke_frame_queue()
    camera2.revoke_frame_queue()
    camera1.close()
    camera2.close()
    vimba.shutdown()
